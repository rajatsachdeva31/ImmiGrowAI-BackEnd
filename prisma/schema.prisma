generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model User {
  email                  String                 @unique
  firebaseUid            String                 @unique
  createdAt              DateTime               @default(now())
  id                     Int                    @id @default(autoincrement())
  roleId                 Int
  DOB                    DateTime
  fullName               String
  phoneNo                String                 @unique
  userVerified           Boolean?               @default(false)
  backgroundVerification Boolean?               @default(false)
  termsConditionCheck    Boolean?               @default(false)
  statusInCanada         String?
  googleRefreshToken     String?
  alreadyInCanada        Boolean?
  countryOfOrigin        String?
  currentLocation        String?
  availableSlots         Availability[]
  carBookings            CarBooking[]
  carDealership          CarDealership?
  carListings            CarListing[]
  coachingSessions       CoachingSession[]
  consultantSessions     ConsultationBooking[]  @relation("Consultant")
  consultationBookings   ConsultationBooking[]  @relation("User")
  favouriteCars          FavouriteCar[]
  favouriteHouses        FavouriteHouse[]
  houseBookings          HouseBooking[]
  houseListings          HouseListing[]
  immigrationConsultant  ImmigrationConsultant?
  jobMatches             JobMatch[]
  mentorProfile          MentorProfile?
  mentorshipMatches      MentorshipMatch[]
  payments               Payment[]
  realtor                Realtor?
  resumeAnalyses         ResumeAnalysis[]
  skillGapAnalyses       SkillGapAnalysis[]
  role                   Role                   @relation(fields: [roleId], references: [id])
  careerProfile          UserCareerProfile?
  userDocuments          UserDocument[]
}

model Realtor {
  id                      Int      @id @default(autoincrement())
  userId                  Int      @unique
  businessName            String
  businessAddress         String?
  realEstateLicenseNumber String
  affiliatedAssociations  String?
  areasCovered            String
  specialties             String
  portfolioWebsite        String?
  businessRegistration    String
  workType                WorkType
  brokerageName           String?
  officeLocationAvailable Boolean
  teamMembers             Int
  virtualPropertyTour     Boolean
  yearsOfExperience       String
  user                    User     @relation(fields: [userId], references: [id])
}

model CarDealership {
  id                      Int     @id @default(autoincrement())
  userId                  Int     @unique
  showroomLocations       String
  testDrivePolicy         String
  financingOptions        String
  tradeInAvailable        Boolean
  serviceWarrantyInfo     String
  businessRegistration    String
  businessName            String
  dealershipLicenseNumber String
  carBrandsSold           String
  newOrUsedCars           String
  yearsInBusiness         String
  user                    User    @relation(fields: [userId], references: [id])
}

model ImmigrationConsultant {
  id                   Int     @id @default(autoincrement())
  userId               Int     @unique
  countriesServed      String
  consultationFee      Float?
  businessRegistration String
  partneredLegalFirms  String?
  websiteOrSocialMedia String?
  businessName         String
  businessAddress      String
  licenseNumber        String
  servicesOffered      String
  languagesSpoken      String
  yearsOfExperience    String
  user                 User    @relation(fields: [userId], references: [id])
}

model Role {
  name  String @unique
  id    Int    @id @default(autoincrement())
  users User[]
}

model HouseListing {
  title         String
  description   String?
  price         Decimal
  location      String
  createdAt     DateTime           @default(now())
  id            Int                @id @default(autoincrement())
  landlordId    Int
  endDate       DateTime?
  endTime       String?
  openhouse     Boolean            @default(false)
  startTime     String?
  startdate     DateTime?
  bathrooms     Int?
  bedrooms      Int?
  squareFeet    Int?
  favourites    FavouriteHouse[]
  houseBookings HouseBooking[]
  houseImages   HouseImage[]
  landlord      User               @relation(fields: [landlordId], references: [id])
  propertyDocs  PropertyDocument[]
}

model CarListing {
  model         String
  make          String
  price         Decimal
  createdAt     DateTime       @default(now())
  id            Int            @id @default(autoincrement())
  dealershipId  Int
  exteriorColor String?
  fuelType      String?
  interiorColor String?
  mileage       Int?
  noOfSeats     Int?
  status        String?
  transmission  String?
  vehicleType   String?
  vin           String?
  year          Int?
  carBookings   CarBooking[]
  carDocs       CarDocument[]
  carImages     CarImage[]
  dealership    User           @relation(fields: [dealershipId], references: [id])
  favourites    FavouriteCar[]
}

model Availability {
  id        Int      @id @default(autoincrement())
  userId    Int
  startTime DateTime
  endTime   DateTime
  status    String
  createdAt DateTime @default(now())
  user      User     @relation(fields: [userId], references: [id])
}

model HouseBooking {
  startDate DateTime
  endDate   DateTime
  status    String
  createdAt DateTime     @default(now())
  id        Int          @id @default(autoincrement())
  userId    Int
  listingId Int
  meetLink  String?
  listing   HouseListing @relation(fields: [listingId], references: [id])
  user      User         @relation(fields: [userId], references: [id])
}

model CarBooking {
  startDate DateTime
  endDate   DateTime
  status    String
  createdAt DateTime   @default(now())
  id        Int        @id @default(autoincrement())
  userId    Int
  listingId Int
  meetLink  String?
  listing   CarListing @relation(fields: [listingId], references: [id])
  user      User       @relation(fields: [userId], references: [id])
}

model ConsultationBooking {
  id           Int      @id @default(autoincrement())
  userId       Int
  startDate    DateTime
  endDate      DateTime
  status       String
  meetLink     String?
  createdAt    DateTime @default(now())
  consultantId Int
  consultant   User     @relation("Consultant", fields: [consultantId], references: [id])
  user         User     @relation("User", fields: [userId], references: [id])
}

model UserDocument {
  documentType String
  fileData     Bytes
  createdAt    DateTime @default(now())
  id           Int      @id @default(autoincrement())
  userId       Int
  user         User     @relation(fields: [userId], references: [id])
}

model PropertyDocument {
  documentType String
  fileData     Bytes
  createdAt    DateTime     @default(now())
  id           Int          @id @default(autoincrement())
  listingId    Int
  listing      HouseListing @relation(fields: [listingId], references: [id])
}

model CarDocument {
  documentType String
  fileData     Bytes
  createdAt    DateTime   @default(now())
  id           Int        @id @default(autoincrement())
  listingId    Int
  listing      CarListing @relation(fields: [listingId], references: [id])
}

model Payment {
  amount          Decimal
  transactionType String
  createdAt       DateTime @default(now())
  id              Int      @id @default(autoincrement())
  userId          Int
  user            User     @relation(fields: [userId], references: [id])
}

model HouseImage {
  imageData Bytes
  createdAt DateTime     @default(now())
  id        Int          @id @default(autoincrement())
  listingId Int
  listing   HouseListing @relation(fields: [listingId], references: [id])
}

model CarImage {
  imageData Bytes
  createdAt DateTime   @default(now())
  id        Int        @id @default(autoincrement())
  listingId Int
  listing   CarListing @relation(fields: [listingId], references: [id])
}

model FavouriteCar {
  id        Int        @id @default(autoincrement())
  userId    Int
  listingId Int
  createdAt DateTime   @default(now())
  listing   CarListing @relation(fields: [listingId], references: [id])
  user      User       @relation(fields: [userId], references: [id])

  @@unique([userId, listingId])
}

model FavouriteHouse {
  id        Int          @id @default(autoincrement())
  userId    Int
  listingId Int
  createdAt DateTime     @default(now())
  listing   HouseListing @relation(fields: [listingId], references: [id])
  user      User         @relation(fields: [userId], references: [id])

  @@unique([userId, listingId], name: "userId_listingId")
}

model UserCareerProfile {
  id                   Int      @id @default(autoincrement())
  userId               Int      @unique
  professionalSummary  String?
  skillsCategories     Json?
  careerObjectives     String?
  targetIndustries     String[]
  marketAlignmentScore Int?
  skillGaps            Json?
  improvementRoadmap   Json?
  lastUpdated          DateTime @default(now())
  createdAt            DateTime @default(now())
  user                 User     @relation(fields: [userId], references: [id])
}

model ResumeAnalysis {
  id                      Int      @id @default(autoincrement())
  userId                  Int
  originalFileName        String
  fileData                Bytes?
  extractedText           String?
  structuredData          Json?
  confidenceScores        Json?
  userCorrections         Json?
  createdAt               DateTime @default(now())
  canadianMarketAnalysis  Json?
  certifications          Json?
  education               Json?
  metadata                Json?
  personalInfo            Json?
  processingMethod        String?
  professionalSummary     String?
  projects                Json?
  skills                  Json?
  workExperience          Json?
  positionRecommendations Json?
  user                    User     @relation(fields: [userId], references: [id])
}

model MentorProfile {
  id                 Int               @id @default(autoincrement())
  userId             Int               @unique
  industryExpertise  String[]
  yearsOfExperience  String
  specializations    String[]
  culturalBackground String?
  languagesSpoken    String[]
  mentorshipCapacity Int               @default(3)
  availabilityHours  Json?
  communicationStyle String[]
  successStories     String?
  isActive           Boolean           @default(true)
  createdAt          DateTime          @default(now())
  user               User              @relation(fields: [userId], references: [id])
  mentorshipMatches  MentorshipMatch[]
}

model MentorshipMatch {
  id                 Int           @id @default(autoincrement())
  mentorId           Int
  menteeId           Int
  compatibilityScore Int
  matchReasoning     Json?
  status             String        @default("pending")
  createdAt          DateTime      @default(now())
  mentee             User          @relation(fields: [menteeId], references: [id])
  mentor             MentorProfile @relation(fields: [mentorId], references: [id])
}

model CoachingSession {
  id                  Int      @id @default(autoincrement())
  userId              Int
  sessionType         String
  conversationHistory Json?
  sessionObjectives   String[]
  outcomes            Json?
  progressMetrics     Json?
  createdAt           DateTime @default(now())
  updatedAt           DateTime @updatedAt
  user                User     @relation(fields: [userId], references: [id])
}

model JobOpportunity {
  id                 Int        @id @default(autoincrement())
  title              String
  company            String
  location           String
  description        String?
  requirements       String[]
  salaryRange        Json?
  jobUrl             String?
  isNewcomerFriendly Boolean    @default(false)
  discoveredAt       DateTime   @default(now())
  isActive           Boolean    @default(true)
  jobMatches         JobMatch[]
}

model JobMatch {
  id                Int            @id @default(autoincrement())
  userId            Int
  jobId             Int
  matchScore        Int
  matchAnalysis     Json?
  skillsGaps        String[]
  applicationStatus String         @default("not_applied")
  createdAt         DateTime       @default(now())
  jobOpportunity    JobOpportunity @relation(fields: [jobId], references: [id])
  user              User           @relation(fields: [userId], references: [id])
}

model SkillGapAnalysis {
  id               Int      @id @default(autoincrement())
  userId           Int
  currentSkills    Json?
  targetSkills     Json?
  identifiedGaps   Json?
  learningPath     Json?
  progressTracking Json?
  lastUpdated      DateTime @default(now())
  user             User     @relation(fields: [userId], references: [id])
}

enum WorkType {
  BROKERAGE
  INDEPENDENT
}
